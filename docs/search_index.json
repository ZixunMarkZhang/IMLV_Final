[["index.html", "Bank Marketing Analysis Chapter 1 Proposal", " Bank Marketing Analysis Zixun Zhang 2023-05-01 Chapter 1 Proposal Data The data set in this project is the Bank Marketing Data Set from UC Irvine Machine Learning Repository. It contains the costumer of bank client. The feature contains as follows: 1 - age (numeric) 2 - job : type of job (categorical: ‘admin.’,‘blue-collar’,‘entrepreneur’,‘housemaid’,‘management’,‘retired’,‘self-employed’,‘services’,‘student’,‘technician’,‘unemployed’,‘unknown’) 3 - marital : marital status (categorical: ‘divorced’,‘married’,‘single’,‘unknown’; note: ‘divorced’ means divorced or widowed) 4 - education (categorical: ‘basic.4y’,‘basic.6y’,‘basic.9y’,‘high.school’,‘illiterate’,‘professional.course’,‘university.degree’,‘unknown’) 5 - default: has credit in default? (categorical: ‘no’,‘yes’,‘unknown’) 6 - housing: has housing loan? (categorical: ‘no’,‘yes’,‘unknown’) 7 - loan: has personal loan? (categorical: ‘no’,‘yes’,‘unknown’) # related with the last contact of the current campaign: 8 - contact: contact communication type (categorical: ‘cellular’,‘telephone’) 9 - month: last contact month of year (categorical: ‘jan’, ‘feb’, ‘mar’, ..., ‘nov’, ‘dec’) 10 - day_of_week: last contact day of the week (categorical: ‘mon’,‘tue’,‘wed’,‘thu’,‘fri’) 11 - duration: last contact duration, in seconds (numeric). Important note: this attribute highly affects the output target (e.g., if duration=0 then y=‘no’). Yet, the duration is not known before a call is performed. Also, after the end of the call y is obviously known. Thus, this input should only be included for benchmark purposes and should be discarded if the intention is to have a realistic predictive model. # other attributes: 12 - campaign: number of contacts performed during this campaign and for this client (numeric, includes last contact) 13 - pdays: number of days that passed by after the client was last contacted from a previous campaign (numeric; 999 means client was not previously contacted) 14 - previous: number of contacts performed before this campaign and for this client (numeric) 15 - poutcome: outcome of the previous marketing campaign (categorical: ‘failure’,‘nonexistent’,‘success’) # social and economic context attributes 16 - emp.var.rate: employment variation rate - quarterly indicator (numeric) 17 - cons.price.idx: consumer price index - monthly indicator (numeric) 18 - cons.conf.idx: consumer confidence index - monthly indicator (numeric) 19 - euribor3m: euribor 3 month rate - daily indicator (numeric) 20 - nr.employed: number of employees - quarterly indicator (numeric) The label of this data set to predict is a binary variable whether the customer subscribed a term deposit. The features will be preprocessed at the beginning of the project. The categorical data will be encoded by one hot encoder. The numerical data will be normalized if it significantly different mean and standard deviation. Modeling Goal Generate a predictive model by which we get specific information of a client and predict if the client subscribed a term deposit. In real world context, this helps the banks to identify the potential client of term deposit service when they utilize the model on customer information. Methodology Various classification methods will be deployed in this projects including logistic regression, decision tree, and random forest. The introduction of each model are shown as follow: 3.1 Logistic regression Logistic regression is a linear classification model where the log odd is predicted by a linear function with the features. Feature selection according to importance and conduct hypothesis test on coefficient are necessary as there might be feature which has minor effect on the labels. 3.2 Decision Tree Decision tree will build a model where the nodes splits by calculating the cutoff with minimum the gini index, and the tree stops generating at gini index reaches 0 at each nodes. After the tree is built, we may access it to make classification predictions. Even if overfitting is likely to happen, we may address this by prune the tree. 3.3 Random Forest Random forest is a model where the classification decision is made according to most common decision tree result in a number of random generated decision trees. This model is also likely to have overfitting. Hyperparameter tuning will be deployed to ensure there is no overfitting. After the models are built, the optimal thresholds will be selected for each model according to context requirement such as high specificity or high sensitivity. The evaluation of the models is not only seeking for accuracy but also interpretability. Visualization tools such as confusion matrix, ROC curve, and feature importance plot will be deployed in the project to ensure the models are understandable and reproducible. At the end of this project, the model selection will be based on not only numerical metrics such as accuracy or loss but also visualized metrics such as feature importance plot and ROC curve to ensure interpretability, acceptable model complexity, and preciseness. Citation [Moro et al., 2014] S. Moro, P. Cortez and P. Rita. A Data-Driven Approach to Predict the Success of Bank Telemarketing. Decision Support Systems, Elsevier, 62:22-31, June 2014, https://archive.ics.uci.edu/ml/datasets/Bank+Marketing "],["eda.html", "Chapter 2 [EDA]", " Chapter 2 [EDA] In this section, we will brief through the data by creating plots for all variables under y=yes and y=no and see if there is differences in distribution. The plot above is a bar plot showing the counts of the response variables y, defined by whether the person has term deposit. It is quite obvious that there are more cases with y equal to no than ones with y equal to yes. However, considering the number of cases included, we do not have to do any sampling or weight adjustment to the data. To begin with, if we take all the numerical data as a whole, we may want to examine if multicolinearity exists in this data. The plot above shows the correlation matrix of all numerical models. From the plot above, we identify that the correlation are high among nr.employed, emp.var.rate, and euribor3m. The correlation between cons.price.idx and emp.var.rate is also high. Hence we may drop nr.employed and emp.var.rate to avoid the problem of multicolinearity at the moment. In the section below, we will take a look of each variable and examine if there are any explicit pattern showing correlation between variables and the target variable. age (numeric). After scaling the age variables, I plot a overlapped numerical histogram showing distribution of age for each y category as shown below. It is obvious that for scaled age larger than 2, the probability of having term deposit largely increases. job : type of job (categorical: ‘admin.’, ‘bluecollar’, ‘entrepreneur’, ‘housemaid’, ‘management’, ‘retired’, ‘self-employed’, ‘services’, ‘student’, ‘technician’, ‘unemployed’, ‘unknown’). This variable will be processed by one hot encoder. The plot shown as follow indicates the distribution of yes and no among all the categories. We can observe that student and retired people are more likely to have term deposit. We may examine the specific impact to the target variable of falling into each category in the following models. marital : marital status (categorical: ‘divorced’,‘married’,‘single’,‘unknown’; note: ‘divorced’ means divorced or widowed). This variable will be processed by one hot encoder. The plot shown as follow indicates the distribution of yes and no among all the categories. There is no obvious pattern observed from the plot. We may examine the specific impact to the target variable of falling into each category in the following models. education (categorical: ‘basic.4y’, ‘basic.6y’, ‘basic.9y’, ‘high.school’, ‘illiterate’, ‘professional.course’, ‘university.degree’, ‘unknown’). This variable will be processed by onehot encoder. The plot shown as follow indicates the distribution of yes and no among all the categories. There is no obvious pattern observed from the plot. We may examine the specific impact to the target variable of falling into each category in the following models. default: has credit in default? (categorical: ‘no’,‘yes’,‘unknown’). The plot shown as follow indicates the distribution of yes and no among all the categories. There is no obvious pattern observed from the plot. We may examine the specific impact to the target variable of falling into each category in the following models. housing: has housing loan? (categorical: ‘no’,‘yes’,‘unknown’). The plot shown as follow indicates the distribution of yes and no among all the categories. There is no obvious pattern observed from the plot. We may examine the specific impact to the target variable of falling into each category in the following models. loan: has personal loan? (categorical: ‘no’,‘yes’,‘unknown’). The plot shown as follow indicates the distribution of yes and no among all the categories. There is no obvious pattern observed from the plot. We may examine the specific impact to the target variable of falling into each category in the following models. # related with the last contact of the current campaign: 8 - contact: contact communication type (categorical: ‘cellular’,‘telephone’). The plot shown as follow indicates the distribution of yes and no among all the categories. There is no obvious pattern observed from the plot. We may examine the specific impact to the target variable of falling into each category in the following models. campaign: number of contacts performed during this campaign and for this client (numeric, includes last contact). After scaling the campaign variables, I plot a overlapped numerical histogram showing distribution of campaign for each y category as shown below. However, there is no obvious difference in pattern of two different categories. pdays: number of days that passed by after the client was last contacted from a previous campaign (numeric; 999 means client was not previously contacted). After scaling the pdays variables, I plot a overlapped numerical histogram showing distribution of age for each y category as shown below. It is worth noticing that when the scaled pdays is negative, the proportion of client with term deposit largely increases. This is a indication of influential variable. previous: number of contacts performed before this campaign and for this client (numeric). After scaling the previous variables, I plot a overlapped numerical histogram showing distribution of previous for each y category as shown below. However, there is no obvious difference in pattern of two different categories. poutcome: outcome of the previous marketing campaign (categorical: ‘failure’,‘nonexistent’,‘success’). This variable will be processed by onehot encoder. The plot shown as follow indicates the distribution of yes and no among all the categories. It is quite obvious that the proportion of having term deposit is much higher for those client has successful previous campaigns. This may be an influential variable to the target variable y. cons.price.idx: consumer price index - monthly indicator (numeric). This variable is renamed as priceIndex for the following analysis. After scaling the priceIndex variables, I plot a overlapped numerical histogram showing distribution of priceIndex for each y category as shown below. It is worth noticing that when the scaled priceIndex is smaller than -1 or larger than 2, the proportion of client with term deposit largely increases. This is a indication of influential variable. cons.conf.idx: consumer confidence index - monthly indicator (numeric). This variable is renamed as confidenceIndex for the following analysis. After scaling the confidenceIndex variables, I plot a overlapped numerical histogram showing distribution of confidenceIndex for each y category as shown below. It is worth noticing that when the scaled confidenceIndex is smaller than -1.5 or larger than 1, the proportion of client with term deposit largely increases. This is a indication of influential variable. euribor3m: Euro Interbank Offered Rate 3 month rate - daily indicator (numeric). This variable is renamed as InterestRateindex for the following analysis. After scaling the InterestRateindex variables, I plot a overlapped numerical histogram showing distribution of InterestRateindex for each y category as shown below. It is worth noticing that when the scaled interestRateIndex is smaller than -1.2 , the proportion of client with term deposit largely increases. This is a indication of influential variable. After briefing through the variables, we separate the dataset to train data and test data proportion 0.2, and we may goes to model creating. "],["logistic-regression.html", "Chapter 3 [Logistic Regression]", " Chapter 3 [Logistic Regression] In this section, we will create a logistic regression model and try to interpret the most important variables and their influence on the target variables. The detailed information of the model is indicated as below. Through the p-values of each variables listed in the right most column, we can observe that whether the contact is via telephone, campaign, pdays, priceIndex, confidenceIndex, and interestRateIndex shows statsitical significance with small p-value. It indicates that these variables are more influential toward the target variable with non-zero coefficient. ## ## Call: ## glm(formula = y ~ ., family = binomial(link = &quot;logit&quot;), data = train_dat) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -1.9410 -0.4355 -0.3347 -0.2798 2.9246 ## ## Coefficients: (4 not defined because of singularities) ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) -1.61814 0.26531 -6.099 1.07e-09 *** ## defaultyes -8.72290 112.70512 -0.077 0.93831 ## housingyes -0.04913 0.04348 -1.130 0.25840 ## loanyes -0.03580 0.06026 -0.594 0.55245 ## contacttelephone -0.70713 0.06474 -10.923 &lt; 2e-16 *** ## maritaldivorced -0.09438 0.08297 -1.138 0.25531 ## maritalmarried -0.01726 0.05365 -0.322 0.74763 ## maritalsingle NA NA NA NA ## educationbasic.4y -0.21236 0.10285 -2.065 0.03895 * ## educationbasic.6y -0.09675 0.12572 -0.770 0.44154 ## educationbasic.9y -0.16431 0.08606 -1.909 0.05622 . ## educationhigh.school -0.10103 0.06083 -1.661 0.09676 . ## educationilliterate 1.74264 0.83871 2.078 0.03773 * ## educationprofessional.course -0.10639 0.07746 -1.373 0.16961 ## educationuniversity.degree NA NA NA NA ## jobadmin. 0.02766 0.13636 0.203 0.83928 ## jobblue.collar -0.21987 0.14581 -1.508 0.13157 ## jobentrepreneur -0.15666 0.18208 -0.860 0.38957 ## jobhousemaid -0.05683 0.20174 -0.282 0.77817 ## jobmanagement -0.03145 0.15404 -0.204 0.83822 ## jobretired 0.37931 0.16737 2.266 0.02343 * ## jobself.employed -0.03745 0.17258 -0.217 0.82822 ## jobservices -0.19673 0.15315 -1.285 0.19895 ## jobstudent 0.43575 0.17404 2.504 0.01229 * ## jobtechnician -0.03683 0.14234 -0.259 0.79582 ## jobunemployed NA NA NA NA ## poutcomefailure -0.76899 0.23631 -3.254 0.00114 ** ## poutcomenonexistent -0.23927 0.23582 -1.015 0.31029 ## poutcomesuccess NA NA NA NA ## age 0.01568 0.02735 0.574 0.56628 ## campaign -0.13304 0.03194 -4.166 3.11e-05 *** ## pdays -0.24163 0.04857 -4.975 6.51e-07 *** ## previous -0.04153 0.03458 -1.201 0.22979 ## priceIndex 0.38584 0.02747 14.044 &lt; 2e-16 *** ## confidenceIndex 0.26208 0.01984 13.207 &lt; 2e-16 *** ## InterestRateindex -1.01481 0.02926 -34.681 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 18612 on 24389 degrees of freedom ## Residual deviance: 14904 on 24358 degrees of freedom ## AIC: 14968 ## ## Number of Fisher Scoring iterations: 10 After the logistic regression models are built, we may access the feature importance by shapley value plot. The plot above is showing the shapley value of each variable sorted by their absolute values of mean shapley values. The most influential 5 variables are interest rate index, price index, default, pdays, and whether the previous campaign fails. To begin with, we create a partial dependence plot(named as PDP plot in following sections) showing the relationship between whether the previous campaign fails and the target variable. For all the PDP plots in this project, we set the y axis as the probability of y=yes instead of log odd by parameter prob=TRUE to make the plot more interpretable. The plot following shows the relationship between interest rate index and probability of y=yes. The line shows decreasing trend with positive concavity, Indicating that the probability of the person having term deposit decreases with the increase in interest rate index. The plot following shows the relationship between price index and probability of y=yes.The line shows increasing trend with positive concavity, Indicating that the probability of the person having term deposit increases with the increase in price index. The plot following is the PDP plot of whether the person has credit default against the target variable. We can observe that if the person has credit default, holding all other variable constant, the person will not have term deposit. The plot following shows the relationship between confidence index and probability of y=yes.The line shows decreasing trend, Indicating that the probability of the person having term deposit decreases with the increase in number of days since last previous campaign. The plot following is the PDP plot of whether the person was contacted via telephone or cellular against the target variable. It is quite obvious that if the previous campaign fails, holding all other variable constant, the person is much less likely to have term deposit at the bank. The following cell shows the test accuracy of logitic regression model. The model accuracy on test data is 0.8876681, which indicates it is a good model. ## [1] 0.8876681 "],["decision-tree.html", "Chapter 4 [Decision Tree]", " Chapter 4 [Decision Tree] In this section, we will create a decision tree model predicting y with all variables introduced in EDA. In the plot below, we generate a full decision tree where all the nodes are pure. However, it is obvious that the decision tree is over complicated and has the problem of overfitting. We may then plot the complexity plot then to prune the tree for making predictions. We may use the full models to visualize and interpret to ensure all variables are considered, In the plot below, we generate a graph of validation error against the complexity parameter of the decision tree. It is quite obvious that the validation error reaches minimum when complexity parameter equal to 0.0027. Hence we may generate another pruned decision tree for prediction with cp=0.0027. The following graph shows the structure of our pruned decision tree. Here we can see that this tree is much simplified with smaller depth. After the decision tree model are built, we may access the feature importance by shapley value plot of the pruned decision tree. The plot following is showing the shapley value of each variable sorted by their absolute values of mean shapley values. The most influential 5 variables are interest rate index, way of contacting, number of contact in this campaign, age, and whether the previous campaign fails,. The following plot shows the relationship between interest rate index and probability of y=yes. The curve shows overall decreasing trend,which is consistent with PDP plot in logistic regression, with a increase at interest rate index equal to negative 1. If we combine this plot with the EDA overlapped histogram in EDA, the pattern is reasonable. The EDA shows deceasing and then increasing in probability in interest rate index &lt;-1, which is the same as what the PDP shows. When the index is larger than 0, the probability is even lower, hence we see another decreasing in the PDP plot. The plot following is the PDP plot of whether the person was contacted via telephone or cellular against the target variable. We can observe that if the contact is by telephone, holding all other variable constant, the person is slightly more likely to have term deposit at the bank.This result may not be so meaningful because the shapley value plots indicates that the lower quantile, median, upper quantile contribution of this variable toward target variable is 0. In other words, decision tree does not create a meaningful boundary distinguishing these two variables. That is also why the PDP plot here shows a small difference in probability. The following plot shows the relationship between number of contact in this campaign and probability of y=yes. The curve shows overall increasing trend,with a decreasing and then increasing at campaign=2.5. If we combine this plot with the EDA overlapped histogram in EDA, the pattern is reasonable. The EDA shows shows a overall increasing in proportion of y=yes with the increase in number of contact, however, the number of yes case is almost zero when campaign reaches 2.5, which explains why we observe such decrease in PDP plot. The following plot shows the relationship between age and probability of y=yes. The curve shows overall increasing trend,with a decreasing and then increasing at campaign=2.5. If we combine this plot with the EDA overlapped histogram in EDA, the pattern is reasonable. The EDA shows shows a overall increasing in proportion of y=yes with the increase in number of contact, however, the number of yes case is almost zero when campaign reaches 2.5, which explains why we observe such decrease in PDP plot. The plot following is the PDP plot of whether the previous campaign fails against the target variable. We can observe that if previous campaign fails, holding all other variable constant, the person is slightly more likely to have term deposit at the bank.this is inconsistent with common sense. This is understandable because the shapley value plots indicates that the lower quantile, median, upper quantile contribution of this variable toward target variable is 0. In other words, decision tree does not create a meaningful boundary distinguishing these two variables. That is also why the PDP plot here shows a smaller difference in probability. The following cell shows the test accuracy of decision tree model. The model accuracy on test data is 0.8896359, which indicates it is a good model. ## [1] 0.8896359 "],["random-forest.html", "Chapter 5 [Random Forest]", " Chapter 5 [Random Forest] After the decision tree model are built, we may access the feature importance by shapley value plot of the random forest. The plot following is showing the shapley value of each variable sorted by their absolute values of mean shapley values. The most influential 5 variables are price index, confidence index, age, whether the previous campaign fails,and whether the person has housing loan. The plot following is the PDP plot of whether the person was contacted via telephone or cellular against the target variable. We can observe that if the contact is by telephone, holding all other variable constant, the person is slightly more likely to have term deposit at the bank.this is inconsistent with what we observed in logistic regression, but same as the decision tree result. This is understandable because the shapley value plots indicates that the lower quantile, median, upper quantile contribution of this variable toward target variable is 0. In other words, random forest does not create a meaningful boundary distinguishing these two variables. That is also why the PDP plot here shows a smaller difference in probability. The plot following is the PDP plot of whether the previous campaign fails against the target variable. We can observe that if previous campaign fails, holding all other variable constant, the person is slightly more likely to have term deposit at the bank.this is inconsistent with what we observed in logistic regression or common sense, but similar to the PDP plot in decision tree section. This is understandable because the shapley value plots indicates that the lower quantile, median, upper quantile contribution of this variable toward target variable is 0. In other words, random forest does not create a meaningful boundary distinguishing these two variables. That is also why the PDP plot here shows a smaller difference in probability. The plot following is the PDP plot of whether the person has housing loan against the target variable. We can observe there is no difference in probability.This is understandable because the shapley value plots indicates that the lower quantile, median, upper quantile contribution of this variable toward target variable is 0. In other words, random forest does not create a meaningful boundary distinguishing these two variables. The following cell shows the test accuracy of random forest model. The model accuracy on test data is 0.8879961, which indicates it is a good model. ## [1] 0.8879961 "],["reflections.html", "Chapter 6 Reflections", " Chapter 6 Reflections "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
